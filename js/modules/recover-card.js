import{changesTitle,formatNumber,productsCounts,productsList,productsPrice,submitButton,totalPrice,priceStocks,priceDiscounts,pricePromo,totalPriceAll,priceDelivery,getItemPrice,productsTitleText,productsTitle}from"./util.js";const recoverTemplate=document.querySelector("#recover").content.querySelector(".card__recover"),titleTemplate=document.querySelector("#basket-empty").content.querySelector(".products__legend-empty"),restoresCard=()=>{const t=Array.from(productsList.children),e=titleTemplate.cloneNode(!0);if(t){let r=0,c=0;t.forEach((t=>{const o=recoverTemplate.cloneNode(!0),a=o.querySelector(".card__recover-button"),s=o.querySelector(".card__recover-delete"),i=t.querySelector(".card__delete"),d=t.querySelector(".card__content"),u=t.querySelector(".card__result-quantity-value");i&&i.addEventListener("click",(()=>{t.removeChild(d),productsCounts.dataset.count=Number(productsCounts.dataset.count)-Number(u.value),productsPrice.dataset.productsPrice=Number(productsPrice.dataset.productsPrice)-Number(u.dataset.totalPriceOld),changesTitle(productsCounts.dataset.count,productsPrice.dataset.productsPrice),0===Number(productsCounts.dataset.count)&&(submitButton.disabled=!0,priceDelivery.dataset.priceDelivery="0",priceDelivery.textContent=formatNumber(priceDelivery.dataset.priceDelivery),pricePromo.dataset.pricePromo="0",pricePromo.textContent=formatNumber(pricePromo.dataset.pricePromo)),totalPrice.dataset.total=Number(totalPrice.dataset.total)-Number(u.dataset.totalPriceOld),totalPrice.textContent=formatNumber(totalPrice.dataset.total),priceStocks.dataset.priceStocks=Number(priceStocks.dataset.priceStocks)-(Number(u.dataset.totalPriceOld)-Number(u.dataset.totalPrice)),priceStocks.textContent=formatNumber(priceStocks.dataset.priceStocks),priceDiscounts.dataset.priceDiscounts=Number(priceStocks.dataset.priceStocks)+Number(pricePromo.dataset.pricePromo),priceDiscounts.textContent=formatNumber(priceDiscounts.dataset.priceDiscounts),totalPriceAll.dataset.priceTotalAll=Number(totalPrice.dataset.total)+Number(priceDelivery.dataset.priceDelivery)-Number(priceDiscounts.dataset.priceDiscounts),totalPriceAll.textContent=formatNumber(totalPriceAll.dataset.priceTotalAll),Number(productsCounts.dataset.count)<=0&&(productsTitle.removeChild(productsTitleText),productsTitle.appendChild(e)),t.appendChild(o)})),a&&a.addEventListener("click",(()=>{t.removeChild(o),t.appendChild(d),productsCounts.dataset.count=Number(productsCounts.dataset.count)+Number(u.value),productsPrice.dataset.productsPrice=Number(productsPrice.dataset.productsPrice)+Number(u.dataset.totalPriceOld),changesTitle(productsCounts.dataset.count,productsPrice.dataset.productsPrice),Number(productsCounts.dataset.count)>0&&(submitButton.disabled=!1,priceDelivery.dataset.priceDelivery="200",priceDelivery.textContent=formatNumber(priceDelivery.dataset.priceDelivery),pricePromo.dataset.pricePromo="500",pricePromo.textContent=formatNumber(pricePromo.dataset.pricePromo)),priceStocks.dataset.priceStocks=Number(priceStocks.dataset.priceStocks)+(Number(u.dataset.totalPriceOld)-Number(u.dataset.totalPrice)),priceStocks.textContent=formatNumber(priceStocks.dataset.priceStocks),priceDiscounts.dataset.priceDiscounts=Number(priceStocks.dataset.priceStocks)+Number(pricePromo.dataset.pricePromo),priceDiscounts.textContent=formatNumber(priceDiscounts.dataset.priceDiscounts),totalPrice.dataset.total=Number(totalPrice.dataset.total)+Number(u.dataset.totalPriceOld),totalPrice.textContent=formatNumber(totalPrice.dataset.total),totalPriceAll.dataset.priceTotalAll=Number(totalPrice.dataset.total)+Number(priceDelivery.dataset.priceDelivery)-Number(priceDiscounts.dataset.priceDiscounts),totalPriceAll.textContent=formatNumber(totalPriceAll.dataset.priceTotalAll),productsTitle.contains(e)&&(productsTitle.removeChild(e),productsTitle.appendChild(productsTitleText))})),s&&s.addEventListener("click",(()=>{t.remove()})),r+=getItemPrice(u),c+=Number(u.value)})),productsCounts.dataset.count=c,productsPrice.dataset.productsPrice=r,changesTitle(productsCounts.dataset.count,productsPrice.dataset.productsPrice)}};export{restoresCard};